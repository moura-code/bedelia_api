# Generated by Django 4.2.6 on 2025-11-08 20:32

from django.db import migrations, models
import django.db.models.deletion
import uuid


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='Carrera',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('nombre', models.CharField(max_length=255, unique=True, verbose_name='Nombre de la Carrera')),
                ('anio_plan', models.CharField(blank=True, max_length=10, null=True, verbose_name='Año del Plan')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),
            ],
            options={
                'verbose_name': 'Carrera',
                'verbose_name_plural': 'Carreras',
                'db_table': 'carreras',
            },
        ),
        migrations.CreateModel(
            name='Curso',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('codigo_universidad', models.CharField(max_length=50, verbose_name='Código de Universidad')),
                ('codigo_curso', models.CharField(max_length=50, verbose_name='Código de Curso')),
                ('nombre_curso', models.CharField(max_length=255, verbose_name='Nombre del Curso')),
                ('creditos', models.IntegerField(default=0, verbose_name='Créditos')),
                ('activo', models.BooleanField(default=True, verbose_name='Activo')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),
                ('carrera', models.ManyToManyField(blank=True, related_name='cursos', to='api.carrera', verbose_name='Carreras')),
            ],
            options={
                'verbose_name': 'Curso',
                'verbose_name_plural': 'Cursos',
                'db_table': 'cursos',
            },
        ),
        migrations.CreateModel(
            name='Previa',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('codigo', models.CharField(blank=True, max_length=255, verbose_name='Código')),
                ('nombre', models.CharField(blank=True, max_length=255, verbose_name='Nombre')),
                ('tipo', models.CharField(choices=[('ALL', 'Debe tener todas'), ('ANY', 'Debe tener alguna'), ('NOT', 'No debe tener'), ('LEAF', 'Hoja (items individuales)')], max_length=10, verbose_name='Tipo')),
                ('titulo', models.CharField(blank=True, max_length=500, null=True, verbose_name='Título')),
                ('cantidad_requerida', models.IntegerField(default=0, verbose_name='Cantidad Requerida')),
                ('orden', models.IntegerField(default=0, verbose_name='Orden')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),
                ('carrera', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='previas', to='api.carrera', verbose_name='Carrera')),
                ('curso', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='previas', to='api.curso', verbose_name='Curso')),
                ('padre', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='hijos', to='api.previa', verbose_name='Nodo Padre')),
            ],
            options={
                'verbose_name': 'Previa',
                'verbose_name_plural': 'Previas',
                'db_table': 'previas',
            },
        ),
        migrations.CreateModel(
            name='Posprevia',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('codigo', models.CharField(max_length=50, verbose_name='Código')),
                ('nombre', models.CharField(max_length=255, verbose_name='Nombre')),
                ('anio_plan', models.CharField(max_length=10, verbose_name='Año del Plan')),
                ('carrera', models.CharField(max_length=255, verbose_name='Carrera')),
                ('fecha', models.CharField(max_length=20, verbose_name='Fecha')),
                ('descripcion', models.TextField(verbose_name='Descripción')),
                ('tipo', models.CharField(choices=[('Curso', 'Curso'), ('Examen', 'Examen')], max_length=20, verbose_name='Tipo')),
                ('materia_codigo', models.CharField(max_length=50, verbose_name='Código de Materia')),
                ('materia_nombre', models.CharField(max_length=255, verbose_name='Nombre de Materia')),
                ('materia_full', models.CharField(max_length=255, verbose_name='Materia Completa')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),
                ('curso', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='posprevias', to='api.curso', verbose_name='Curso')),
            ],
            options={
                'verbose_name': 'Posprevia',
                'verbose_name_plural': 'Posprevias',
                'db_table': 'posprevias',
            },
        ),
        migrations.CreateModel(
            name='ItemPrevia',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('fuente', models.CharField(max_length=50, verbose_name='Fuente')),
                ('modalidad', models.CharField(max_length=50, verbose_name='Modalidad')),
                ('codigo', models.CharField(max_length=50, verbose_name='Código')),
                ('titulo', models.CharField(max_length=500, verbose_name='Título')),
                ('notas', models.JSONField(blank=True, default=list, verbose_name='Notas')),
                ('texto_raw', models.TextField(blank=True, verbose_name='Texto Raw')),
                ('orden', models.IntegerField(default=0, verbose_name='Orden')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),
                ('previa', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='items', to='api.previa', verbose_name='Previa (nodo LEAF)')),
            ],
            options={
                'verbose_name': 'Item de Previa',
                'verbose_name_plural': 'Items de Previa',
                'db_table': 'items_previa',
                'ordering': ['orden'],
            },
        ),
        migrations.AddIndex(
            model_name='carrera',
            index=models.Index(fields=['nombre'], name='idx_carrera_nombre'),
        ),
        migrations.AddIndex(
            model_name='carrera',
            index=models.Index(fields=['anio_plan'], name='idx_carrera_anio'),
        ),
        migrations.AlterUniqueTogether(
            name='carrera',
            unique_together={('nombre', 'anio_plan')},
        ),
        migrations.AddIndex(
            model_name='previa',
            index=models.Index(fields=['curso'], name='idx_previa_curso'),
        ),
        migrations.AddIndex(
            model_name='previa',
            index=models.Index(fields=['padre'], name='idx_previa_padre'),
        ),
        migrations.AddIndex(
            model_name='previa',
            index=models.Index(fields=['tipo'], name='idx_previa_tipo'),
        ),
        migrations.AddIndex(
            model_name='previa',
            index=models.Index(fields=['carrera'], name='idx_previa_carrera'),
        ),
        migrations.AddIndex(
            model_name='posprevia',
            index=models.Index(fields=['curso'], name='idx_posprevia_curso'),
        ),
        migrations.AddIndex(
            model_name='posprevia',
            index=models.Index(fields=['codigo'], name='idx_posprevia_codigo'),
        ),
        migrations.AddIndex(
            model_name='posprevia',
            index=models.Index(fields=['materia_codigo'], name='idx_posprevia_materia_codigo'),
        ),
        migrations.AddIndex(
            model_name='posprevia',
            index=models.Index(fields=['carrera', 'anio_plan'], name='idx_posprevia_carrera_anio'),
        ),
        migrations.AddIndex(
            model_name='itemprevia',
            index=models.Index(fields=['previa', 'orden'], name='idx_item_previa_orden'),
        ),
        migrations.AddIndex(
            model_name='itemprevia',
            index=models.Index(fields=['codigo'], name='idx_item_codigo'),
        ),
        migrations.AddIndex(
            model_name='itemprevia',
            index=models.Index(fields=['modalidad'], name='idx_item_modalidad'),
        ),
        migrations.AddIndex(
            model_name='curso',
            index=models.Index(fields=['codigo_curso'], name='idx_codigo_curso'),
        ),
        migrations.AddIndex(
            model_name='curso',
            index=models.Index(fields=['codigo_universidad'], name='idx_codigo_universidad'),
        ),
        migrations.AddIndex(
            model_name='curso',
            index=models.Index(fields=['activo'], name='idx_curso_activo'),
        ),
        migrations.AlterUniqueTogether(
            name='curso',
            unique_together={('codigo_universidad', 'codigo_curso')},
        ),
    ]
